{% extends "base.html" %}

{% block custom_css %}
<style>
    .song-header {
        background-color: #3b3b3b;
        color: white;
        padding: 20px;
    }

    .song-header .title {
        margin-bottom: 20px;
    }

    .song-header .subtitle {
        margin-top: 0;
        font-size: 1.2rem;
        color: #bfbfbf;
    }

    .song-header .buttons {
        margin-top: 15px;
    }
</style>
{% endblock %}

{% block content %}
<div class="song-header">
    <h1 class="title">{{ song.title }}</h1>
    <p class="subtitle">
        By: {{ artist.name }} | Scrobbles: {{ scrobbles }}
    </p>
    <div class="buttons">
        {% if current_user.is_authenticated %}
            <button id="like-song" data-id="{{ song.id }}">Like</button>
            <button id="save-song" data-id="{{ song.id }}">Save</button>
        {% endif %}
    </div>
</div>

<div class="content">
    <h2>About This Song</h2>
    <p><strong>Duration:</strong> {{ duration }}</p>

    <div class="tags">
        {% for tag in song.tags %}
            <span class="tag is-primary">{{ tag }}</span>
        {% endfor %}
    </div>
</div>
{% block custom_js %}
<script>
    // Handle Like button
    document.getElementById("like-song")?.addEventListener("click", function(e) {
        e.preventDefault();
        var item_id = this.dataset.id;
        var item_type = 'song';

        fetch(`/like/${item_type}/${item_id}`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            }
        })
        .then(response => response.json())
        .then(data => {
            alert(data.message); // Show success message
        })
        .catch(error => console.error('Error:', error));
    });

    // Handle Save button
    document.getElementById("save-song")?.addEventListener("click", function(e) {
        e.preventDefault();
        var item_id = this.dataset.id;
        var item_type = 'song';

        fetch(`/save/${item_type}/${item_id}`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            }
        })
        .then(response => response.json())
        .then(data => {
            alert(data.message); // Show success message
        })
        .catch(error => console.error('Error:', error));
    });
</script>
{% endblock %}
{% endblock %}